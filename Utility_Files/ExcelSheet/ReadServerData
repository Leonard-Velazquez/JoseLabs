import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.util.HashMap;
import java.util.Iterator;
import java.util.Map;

import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.ss.usermodel.Workbook;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

public class ReadServerData {
	public static void main(String args[]) {

		String readExcel = "D://Server Data.xlsx";
		FileInputStream fis;
		Workbook workBook1;
		Sheet sheet1;
		Row row;
		Cell cell, cell1;
		Map<String, String> addList = new HashMap<>();
		int count=0;
		try {
			fis = new FileInputStream(new File(readExcel));
			workBook1 = new XSSFWorkbook(fis);

			sheet1 = workBook1.getSheetAt(0);
			for (int i = 0; i < sheet1.getLastRowNum() + 1; i++) {

				row = sheet1.getRow(i);
				cell = row.getCell(1);

				cell1 = row.getCell(6);
				// System.out.println(cell.getStringCellValue() + " " +
				// cell1.getStringCellValue());
				// addList.put(cell.getStringCellValue(),
				// cell1.getStringCellValue());
				addList.put(cell.getStringCellValue().toString(), cell1.getStringCellValue().toString());
			}
			System.out.println("@@@@@@@"+addList.keySet().size());
			System.out.println(addList);
			Iterator<Map.Entry<String, String>> itr = addList.entrySet().iterator();
		
			while (itr.hasNext()) {
				System.out.println("$$$$$$$");
				Map.Entry<String, String> itrEntry = itr.next();
				if (itrEntry.getValue().toString().equals("succeeded")) {
					System.out.println("#####" + itrEntry.getKey().toString());
					count++;
				}

			}
			System.out.println(count);

		} catch (FileNotFoundException e) {
			// TODO Auto-generated catch block
			System.out.println(e.getLocalizedMessage());
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}

	}
}
