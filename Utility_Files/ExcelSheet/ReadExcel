import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.net.HttpURLConnection;
import java.net.URL;
import java.util.HashMap;
import java.util.Iterator;
import java.util.Map;
import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.ss.usermodel.Workbook;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

public class ReadExcel {
	public static void main(String args[]) {
		String readExcel = "D://Copy of test URLS.xlsx";
		FileInputStream fis;
		Workbook workBook, workBook1 = null;
		FileOutputStream fos;
		Sheet firstSheet, writeSheet;
		int i1 = 0, totalCount = 0;
		HttpURLConnection conn;
		URL url = null;
		Cell cell;
		Row row, row1;
		Map<Cell, Integer> testMapValue = new HashMap<>();
		try {
			fis = new FileInputStream(new File(readExcel));
			workBook = new XSSFWorkbook(fis);
			firstSheet = workBook.getSheetAt(0);
			fos = new FileOutputStream(new File("D://responsesheet.xlsx"));
			workBook1 = new XSSFWorkbook();
			writeSheet = workBook1.createSheet("URL List");

			for (int i = 0; i < firstSheet.getLastRowNum() + 1; i++) {
				row = firstSheet.getRow(i);
				cell = row.getCell(0);
				try {
					url = new URL(cell.toString());
					conn = (HttpURLConnection) url.openConnection();

					int value = conn.getResponseCode();

					testMapValue.put(cell, value);
				} catch (Exception e) {
					System.out.println(e.getLocalizedMessage() + " URL is " + url);
				}
				System.out.println("$$$$$");
				totalCount++;
			}

			Iterator<Map.Entry<Cell, Integer>> itr = testMapValue.entrySet().iterator();
			while (itr.hasNext()) {
				Map.Entry<Cell, Integer> entry = itr.next();
				row1 = writeSheet.createRow(i1);
				row1.createCell(0).setCellValue(entry.getKey().toString());
				row1.createCell(1).setCellValue(entry.getValue().toString());

				i1++;

			}

			workBook1.write(fos);
			fos.flush();
			fos.close();
			fis.close();
			System.out.println("Total lines Read:" + totalCount);
		} catch (IOException e) {
			// TODO Auto-generated catch block
			System.out.println(e.getLocalizedMessage() + " URL is" + url);
		}

	}
}
